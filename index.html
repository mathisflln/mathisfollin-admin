<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - FAH Marie-Curie</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/common.css">
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="auth-checking">
  <!-- Loader auth -->
  <div class="auth-loader" id="auth-loader">
    <div class="spinner"></div>
  </div>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <a href="https://mathisfollin.fr" class="sidebar-logo">
        <img src="https://mathisfollin.fr/assets/logos/fah-white.png" alt="FAH Marie-Curie" />
      </a>
      <span class="admin-badge">ADMIN</span>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <div class="nav-section-title">Gestion</div>
        
        <a href="#" class="nav-item" data-view="overview">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
          <span>Vue d'ensemble</span>
        </a>
        
        <a href="#" class="nav-item" data-view="articles">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
          <span>Articles</span>
        </a>
        
        <a href="#" class="nav-item" data-view="quiz">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
          <span>Quiz</span>
        </a>
        
        <a href="#" class="nav-item" data-view="documents">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
          <span>Documents</span>
        </a>
        
        <a href="#" class="nav-item" data-view="events">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          <span>√âv√©nements</span>
        </a>
      </div>
      
      <div class="nav-section">
        <div class="nav-section-title">Communication</div>
        
        <a href="#" class="nav-item" data-view="emails">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          <span>Emails</span>
        </a>
        
        <a href="#" class="nav-item" data-view="invites">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
          <span>Inviter des membres</span>
        </a>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar" id="user-avatar">A</div>
        <div class="user-details">
          <div class="user-name" id="user-name">Admin</div>
          <div class="user-role">Administrateur</div>
        </div>
      </div>
      <button class="btn-logout" id="logout">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
        Se d√©connecter
      </button>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">
    <!-- VUE OVERVIEW -->
    <div id="view-overview" class="view-section active">
      <div class="page-header">
        <h1 class="page-title">Bienvenue <span id="welcome-name"></span> üëã</h1>
        <p class="page-subtitle">G√©rez le contenu de la plateforme FAH Marie-Curie</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
          </div>
          <div class="stat-value" id="stat-articles">‚Äî</div>
          <div class="stat-label">Articles</div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
          </div>
          <div class="stat-value" id="stat-quizzes">‚Äî</div>
          <div class="stat-label">Quiz</div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
          </div>
          <div class="stat-value" id="stat-docs">‚Äî</div>
          <div class="stat-label">Documents</div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          </div>
          <div class="stat-value" id="stat-events">‚Äî</div>
          <div class="stat-label">√âv√©nements</div>
        </div>
      </div>

      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Acc√®s rapide</h2>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
          <div class="stat-card" style="cursor: pointer;" data-view="articles">
            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">üìù Nouvel article</div>
            <div style="font-size: 0.85rem; color: #999;">Cr√©er un article</div>
          </div>
          <div class="stat-card" style="cursor: pointer;" data-view="quiz">
            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">üß™ Nouveau quiz</div>
            <div style="font-size: 0.85rem; color: #999;">Cr√©er un quiz</div>
          </div>
          <div class="stat-card" style="cursor: pointer;" data-view="documents">
            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">üìÑ Nouveau document</div>
            <div style="font-size: 0.85rem; color: #999;">Uploader un document</div>
          </div>
          <div class="stat-card" style="cursor: pointer;" data-view="events">
            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">üìÖ Nouvel √©v√©nement</div>
            <div style="font-size: 0.85rem; color: #999;">Cr√©er un √©v√©nement</div>
          </div>
          <div class="stat-card" style="cursor: pointer;" data-view="emails">
            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px;">üìß Envoyer un email</div>
            <div style="font-size: 0.85rem; color: #999;">Email group√© aux membres</div>
          </div>
        </div>
      </div>
    </div>

    <!-- VUE ARTICLES -->
    <div id="view-articles" class="view-section">
      <div class="page-header">
        <h1 class="page-title">Articles</h1>
        <p class="page-subtitle">G√©rez les articles du blog</p>
      </div>
      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Tous les articles</h2>
          <button class="btn-create" id="btn-new-article">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            Nouvel article
          </button>
        </div>
        <div id="articles-list"></div>
      </div>
    </div>

    <!-- VUE QUIZ -->
    <div id="view-quiz" class="view-section">
      <div class="page-header">
        <h1 class="page-title">Quiz</h1>
        <p class="page-subtitle">G√©rez les quiz de la plateforme</p>
      </div>
      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Tous les quiz</h2>
          <button class="btn-create" id="btn-new-quiz">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            Nouveau quiz
          </button>
        </div>
        <div id="quiz-list"></div>
      </div>
    </div>

    <!-- VUE DOCUMENTS -->
    <div id="view-documents" class="view-section">
      <div class="page-header">
        <h1 class="page-title">Documents</h1>
        <p class="page-subtitle">G√©rez les documents de l'association</p>
      </div>
      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Tous les documents</h2>
          <button class="btn-create" id="btn-new-document">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            Nouveau document
          </button>
        </div>
        <div id="documents-list"></div>
      </div>
    </div>

    <!-- VUE √âV√âNEMENTS -->
    <div id="view-events" class="view-section">
      <div class="page-header">
        <h1 class="page-title">√âv√©nements</h1>
        <p class="page-subtitle">G√©rez les √©v√©nements de l'association</p>
      </div>
      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Tous les √©v√©nements</h2>
          <button class="btn-create" id="btn-new-event">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            Nouvel √©v√©nement
          </button>
        </div>
        <div id="events-list"></div>
      </div>
    </div>

    <!-- VUE EMAILS -->
    <div id="view-emails" class="view-section">
      <div class="page-header">
        <h1 class="page-title">Envoyer un email</h1>
        <p class="page-subtitle">Envoyez des emails √† tous les membres inscrits</p>
      </div>
      <div class="content-section">
        <form id="email-form">
          <div class="form-group">
            <label class="form-label">Objet de l'email *</label>
            <input type="text" class="form-input" id="email-subject" required placeholder="Ex: Information importante">
          </div>
          
          <div class="form-group">
            <label class="form-label">Contenu de l'email *</label>
            <div class="rich-editor">
              <div class="editor-toolbar">
                <button type="button" class="editor-btn" data-command="bold" data-target="email"><strong>Gras</strong></button>
                <button type="button" class="editor-btn" data-command="italic" data-target="email"><em>Italique</em></button>
                <button type="button" class="editor-btn" data-command="underline" data-target="email"><u>Soulign√©</u></button>
                <button type="button" class="editor-btn" data-command="insertUnorderedList" data-target="email">‚Ä¢ Liste</button>
                <button type="button" class="editor-btn" data-command="formatBlock" data-value="h2" data-target="email">Titre 2</button>
                <button type="button" class="editor-btn" data-command="formatBlock" data-value="h3" data-target="email">Titre 3</button>
                <button type="button" class="editor-btn" data-command="createLink" data-target="email">üîó Lien</button>
              </div>
              <div class="editor-content" id="email-content" contenteditable="true"></div>
            </div>
            <p style="font-size: 0.85rem; color: #999; margin-top: 8px;">
              üí° Astuce : Le contenu sera automatiquement mis en page avec le design FAH Marie-Curie
            </p>
          </div>

          <div style="background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
            <div style="font-size: 0.9rem; font-weight: 500; color: #e5e5e5; margin-bottom: 8px;">üìä Destinataires</div>
            <div style="font-size: 0.85rem; color: #999;">
              L'email sera envoy√© √† <strong id="users-count" style="color: #FFFF10;">‚Äî</strong> membres inscrits
            </div>
          </div>

          <div class="modal-actions">
            <button type="submit" class="btn-modal btn-primary" style="flex: none; padding: 14px 32px;">
              üìß Envoyer √† tous les membres
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- VUE INVITES -->
    <div id="view-invites" class="view-section">
      <div class="page-header">
        <h1 class="page-title">Inviter des membres</h1>
        <p class="page-subtitle">Envoyez des invitations par email</p>
      </div>
      <div class="content-section">
        <form id="invite-form">
          <div class="form-group">
            <label class="form-label">Adresses email *</label>
            <textarea class="form-textarea" id="invite-emails" placeholder="email1@exemple.com&#10;email2@exemple.com&#10;email3@exemple.com" style="min-height: 200px;" required></textarea>
            <p style="font-size: 0.85rem; color: #999; margin-top: 8px;">
              üí° Entrez une adresse email par ligne
            </p>
          </div>

          <div style="background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
            <div style="font-size: 0.9rem; font-weight: 500; color: #e5e5e5; margin-bottom: 8px;">üì® Fonctionnement</div>
            <div style="font-size: 0.85rem; color: #999; line-height: 1.6;">
              Les personnes recevront un email d'invitation Supabase pour cr√©er leur compte et rejoindre la plateforme FAH Marie-Curie.
            </div>
          </div>

          <div class="modal-actions">
            <button type="submit" class="btn-modal btn-primary" style="flex: none; padding: 14px 32px;">
              üì§ Envoyer les invitations
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- MODAL ARTICLE -->
  <div id="article-modal" class="modal">
    <div class="modal-content wide">
      <div class="modal-header">
        <h2 class="modal-title" id="article-modal-title">Nouvel article</h2>
        <button class="btn-close-modal" id="btn-close-article">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <form id="article-form">
        <div class="form-group">
          <label class="form-label">Titre *</label>
          <input type="text" class="form-input" id="article-title" required>
        </div>
        
        <div class="form-group">
          <label class="form-label">Contenu *</label>
          <div class="rich-editor">
            <div class="editor-toolbar">
              <button type="button" class="editor-btn" data-command="bold"><strong>Gras</strong></button>
              <button type="button" class="editor-btn" data-command="italic"><em>Italique</em></button>
              <button type="button" class="editor-btn" data-command="underline"><u>Soulign√©</u></button>
              <button type="button" class="editor-btn" data-command="insertUnorderedList">‚Ä¢ Liste</button>
              <button type="button" class="editor-btn" data-command="insertOrderedList">1. Num√©rot√©e</button>
              <button type="button" class="editor-btn" data-command="formatBlock" data-value="h2">Titre 2</button>
              <button type="button" class="editor-btn" data-command="formatBlock" data-value="h3">Titre 3</button>
              <button type="button" class="editor-btn" data-command="createLink">üîó Lien</button>
            </div>
            <div class="editor-content" id="article-content" contenteditable="true"></div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Image de couverture (URL)</label>
          <input type="text" class="form-input" id="article-cover">
        </div>
        <div class="form-group">
          <label class="form-label">Statut</label>
          <select class="form-select" id="article-published">
            <option value="false">Brouillon</option>
            <option value="true">Publi√©</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-modal btn-secondary" id="btn-cancel-article">Annuler</button>
          <button type="submit" class="btn-modal btn-primary">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL QUIZ -->
  <div id="quiz-modal" class="modal">
    <div class="modal-content wide">
      <div class="modal-header">
        <h2 class="modal-title" id="quiz-modal-title">Nouveau quiz</h2>
        <button class="btn-close-modal" id="btn-close-quiz">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <form id="quiz-form">
        <div class="form-group">
          <label class="form-label">Titre *</label>
          <input type="text" class="form-input" id="quiz-title" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" style="min-height: 100px;" id="quiz-description"></textarea>
        </div>
        
        <div class="form-group">
          <label class="form-label">Questions</label>
          <div class="quiz-builder" id="quiz-builder"></div>
          <button type="button" class="btn-add-question" id="btn-add-quiz-question">
            + Ajouter une question
          </button>
        </div>
        
        <div class="modal-actions">
          <button type="button" class="btn-modal btn-secondary" id="btn-cancel-quiz">Annuler</button>
          <button type="submit" class="btn-modal btn-primary">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL DOCUMENT -->
  <div id="document-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Nouveau document</h2>
        <button class="btn-close-modal" id="btn-close-document">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <form id="document-form">
        <div class="form-group">
          <label class="form-label">Titre *</label>
          <input type="text" class="form-input" id="document-title" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" id="document-description"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Fichier *</label>
          <input type="file" class="form-file" id="document-file" required>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-modal btn-secondary" id="btn-cancel-document">Annuler</button>
          <button type="submit" class="btn-modal btn-primary">Uploader</button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL √âV√âNEMENT -->
  <div id="event-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="event-modal-title">Nouvel √©v√©nement</h2>
        <button class="btn-close-modal" id="btn-close-event">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <form id="event-form">
        <div class="form-group">
          <label class="form-label">Titre *</label>
          <input type="text" class="form-input" id="event-title" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" id="event-description"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Date et heure *</label>
          <input type="datetime-local" class="form-input" id="event-date" required>
        </div>
        <div class="form-group">
          <label class="form-label">Lieu</label>
          <input type="text" class="form-input" id="event-location">
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-modal btn-secondary" id="btn-cancel-event">Annuler</button>
          <button type="submit" class="btn-modal btn-primary">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="/js/supabase-client.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/components.js"></script>
  <script src="/js/router.js"></script>
  <script src="/js/admin.js"></script>
</body>
</html>